<!DOCTYPE html>
<html>
    <head>
        <title>Admin Panel</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    </head>
    <body class="bg-light">
        <div class="container mt-5">
            <h2 class="mb-4">Admin Panel - Manage Products</h2>
            <!-- Add Product Form -->
            <div class="card p-3 mb-4">
                <h5>Add New Product</h5>
                <div class="row g-2">
                    <div class="col-md-3">
                        <input id="name" class="form-control" placeholder="Product Name">
                    </div>
                    <div class="col-md-2">
                        <input id="price" type="number" class="form-control" placeholder="Price">
                    </div>
                    <div class="col-md-3">
                        <input id="image" class="form-control" placeholder="Image URL">
                    </div>
                    <div class="col-md-2">
                        <input id="stock" type="number" class="form-control" placeholder="Stock">
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-success w-100" onclick="addProduct()">Add</button>
                    </div>
                </div>
            </div>
            <!-- Product Table -->
            <div class="card p-3">
                <h5>All Products</h5>
                <table class="table table-bordered mt-3">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Price</th>
                            <th>Stock</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="product-table"></tbody>
                </table>
            </div>
        </div>
        <script>
            async function loadProducts() {
                const res = await fetch("http://localhost:5000/products");
                const products = await res.json();
                const table = document.getElementById("product-table");
                table.innerHTML = "";
                products.forEach(p => {
                    table.innerHTML += `
                        <tr>
                            <td>${p.id}</td>
                            <td>${p.name}</td>
                            <td>â‚¹${p.price}</td>
                            <td>${p.stock}</td>
                            <td>
                                <button class="btn btn-danger btn-sm" onclick="deleteProduct(${p.id})">Delete</button>
                            </td>
                        </tr>
                    `;
                });
            }
            async function addProduct() {
                const name = document.getElementById("name").value;
                const price = document.getElementById("price").value;
                const image = document.getElementById("image").value;
                const stock = document.getElementById("stock").value;
                await fetch("http://localhost:5000/products", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        name: name,
                        description: "New product",
                        price: price,
                        image_url: image,
                        stock: stock,
                        category: "Electronics",
                        rating: 4,
                        oldPrice: price
                    })
                });
                loadProducts();
            }
            async function deleteProduct(id) {
                await fetch(`http://localhost:5000/products/${id}`, {
                    method: "DELETE"
                });
                loadProducts();
            }
            loadProducts();
        </script>
    </body>
</html>
